import{d as J,r as p,s as K,l as O,k as Q,v as f,c as r,o as a,a as l,m as w,e as d,f as g,i as t,b as u,t as c,F as k,h as P,p as _,_ as W}from"./index-Dh5izbV7.js";import{r as X,a as Y}from"./building-sale-DAoCUAi5.js";import{B as I}from"./base-util-LDrhyDoM.js";const Z={class:"house-detail-page"},ee={key:0,class:"detail-content"},se={key:1,class:"no-image"},te={class:"price-section"},oe={class:"price"},ne={class:"amount"},ae={class:"title"},ie={class:"tags"},le={class:"house-params"},re={class:"params-grid"},ce={class:"param-item"},de={class:"value"},ue={class:"param-item"},ve={class:"value"},me={class:"param-item"},pe={class:"value"},_e={class:"facilities-section"},fe={class:"facilities-grid"},ge={class:"facility-name"},he={class:"landlord-section"},ye={class:"landlord-header"},be={class:"landlord-info"},we={class:"name"},ke={class:"verified"},Pe={class:"community-info"},Ie={key:2,class:"description-section"},Te={class:"description-content"},Ce={key:1,class:"loading-container"},Ue={key:2,class:"bottom-actions"},$e={class:"action-buttons"},xe={key:3,class:"bottom-actions"},He={class:"action-buttons"},De=J({__name:"HouseDetail",setup(Be){const $=Q(),o=p({}),h=p(!1),T=p(0),C=p([]),x=p([{name:"床",icon:"hotel-o"},{name:"冰箱",icon:"refrigerator-o"},{name:"电视机",icon:"tv-o"},{name:"沙发",icon:"bag-o"},{name:"空调",icon:"fire-o"},{name:"衣柜",icon:"cluster-o"},{name:"洗衣机",icon:"other-pay"},{name:"热水器",icon:"fire-o"}]),y=K(()=>{const e=[];if(o.value.coverPath&&e.push(o.value.coverPath),o.value.buildingTradeImages&&o.value.buildingTradeImages.length>0){const s=o.value.buildingTradeImages.map(n=>n.filePath).filter(n=>n&&!e.includes(n));e.push(...s)}return e});O(()=>{H()});const H=async()=>{const{id:e,type:s}=$.query;if(!e||!s){f("参数错误");return}try{if(s==="rental"){const{data:n}=await X.detail(e);o.value=U(n,"rental")}else if(s==="sale"){const{data:n}=await Y.detail(e);o.value=U(n,"sale")}C.value=y.value}catch(n){console.error("获取详情失败:",n),f("获取详情失败")}},U=(e,s)=>e?(e.coverPath&&(e.coverPath=I.getUploadPath(e.coverPath)),e.buildingTradeImages&&e.buildingTradeImages.length>0&&(e.buildingTradeImages=e.buildingTradeImages.map(n=>({...n,filePath:I.getUploadPath(n.filePath)}))),e.publishUserHeadPath&&(e.publishUserHeadPath=I.getUploadPath(e.publishUserHeadPath)),s==="rental"?e.price=e.rentalPrice:s==="sale"&&(e.price=e.salePrice),e):{},D=e=>{const s=e.type===1?"整租":"车位",n=e.community?.name||"",v=e.introduction||"";return`${s}·${n}${v?`.${v}`:""}`},B=e=>e.type===1&&e.room&&e.room.typeName||"-",N=e=>e.type===1&&e.room&&e.room.area?`${e.room.area}M²`:"-",L=e=>e.room&&e.room.floor?e.room.floor:"高层/6层",M=e=>e.community?.name||"未知小区",V=e=>({1:"进行中",2:"已完成",3:"已取消"})[e]||"未知",q=e=>{T.value=e,h.value=!0},F=()=>{f("在线聊功能开发中")},R=e=>{if(!e){f("暂无联系电话");return}window.location.href=`tel:${e}`};return(e,s)=>{const n=d("van-nav-bar"),v=d("van-image"),S=d("van-swipe-item"),z=d("van-swipe"),A=d("van-tag"),m=d("van-icon"),E=d("van-loading"),b=d("van-button"),j=d("van-image-preview");return a(),r("div",Z,[l(n,{title:"租房详情","left-arrow":"",onClickLeft:s[0]||(s[0]=i=>e.$router.back()),fixed:"",placeholder:""}),o.value.id?(a(),r("div",ee,[y.value.length>0?(a(),g(z,{key:0,class:"detail-swipe",autoplay:3e3,onClick:s[1]||(s[1]=i=>q(0))},{default:u(()=>[(a(!0),r(k,null,P(y.value,(i,G)=>(a(),g(S,{key:G},{default:u(()=>[l(v,{src:i,fit:"cover",width:"100%",height:"200px"},null,8,["src"])]),_:2},1024))),128))]),_:1})):(a(),r("div",se,"暂无图片")),t("div",te,[t("div",oe,[t("span",ne,c(o.value.price),1),s[4]||(s[4]=t("span",{class:"unit"},"/月",-1)),s[5]||(s[5]=t("span",{class:"payment"},"押一付三",-1))]),t("div",ae,c(D(o.value)),1),t("div",ie,[(a(!0),r(k,null,P(o.value.buildingTradeTags,i=>(a(),g(A,{key:i.id,type:"primary",plain:"",size:"medium"},{default:u(()=>[_(c(i.title),1)]),_:2},1024))),128))])]),t("div",le,[s[9]||(s[9]=t("div",{class:"section-header"},[t("span",{class:"title"},"房屋参数"),t("span",{class:"more"},"详细参数>")],-1)),t("div",re,[t("div",ce,[s[6]||(s[6]=t("div",{class:"label"},"房型",-1)),t("div",de,c(B(o.value)||"-"),1)]),t("div",ue,[s[7]||(s[7]=t("div",{class:"label"},"面积",-1)),t("div",ve,c(N(o.value)),1)]),t("div",me,[s[8]||(s[8]=t("div",{class:"label"},"楼层",-1)),t("div",pe,c(L(o.value)),1)])])]),t("div",_e,[s[10]||(s[10]=t("div",{class:"section-header"},[t("span",{class:"title"},"设施/服务"),t("span",{class:"more"},"更多服务>")],-1)),t("div",fe,[(a(!0),r(k,null,P(x.value,i=>(a(),r("div",{class:"facility-item",key:i.name},[l(m,{name:i.icon,size:"24"},null,8,["name"]),t("span",ge,c(i.name),1)]))),128))])]),t("div",he,[t("div",ye,[o.value.publishUserHeadPath?(a(),g(v,{key:0,src:o.value.publishUserHeadPath,round:"",width:"50",height:"50"},null,8,["src"])):w("",!0),t("div",be,[t("div",we,c(o.value.contactName||"匿名用户"),1),t("div",ke,[l(m,{name:"certificate",color:"#1989fa"}),s[11]||(s[11]=t("span",null,"已验证房东身份",-1))])])]),t("div",Pe,[l(m,{name:"location-o"}),t("span",null,"小区·"+c(M(o.value)),1)]),s[12]||(s[12]=t("div",{class:"map-link"},[t("span",null,"地图详情>")],-1))]),o.value.introduction?(a(),r("div",Ie,[s[13]||(s[13]=t("div",{class:"section-header"},[t("span",{class:"title"},"房源描述")],-1)),t("div",Te,c(o.value.introduction),1)])):w("",!0)])):(a(),r("div",Ce,[l(E,{type:"spinner",class:"loading"},{default:u(()=>[...s[14]||(s[14]=[_("加载中...",-1)])]),_:1})])),o.value.id&&o.value.status===1?(a(),r("div",Ue,[t("div",$e,[l(b,{class:"chat-btn",onClick:F},{default:u(()=>[l(m,{name:"chat-o"}),s[15]||(s[15]=_(" 在线聊 ",-1))]),_:1}),l(b,{class:"call-btn",type:"primary",onClick:s[2]||(s[2]=i=>R(o.value.contactPhone))},{default:u(()=>[l(m,{name:"phone-o"}),s[16]||(s[16]=_(" 打电话 ",-1))]),_:1})])])):o.value.id&&o.value.status!==1?(a(),r("div",xe,[t("div",He,[l(b,{class:"disabled-btn",disabled:"",block:""},{default:u(()=>[_(c(V(o.value.status)),1)]),_:1})])])):w("",!0),l(j,{show:h.value,"onUpdate:show":s[3]||(s[3]=i=>h.value=i),images:C.value,"start-position":T.value},null,8,["show","images","start-position"])])}}}),Ve=W(De,[["__scopeId","data-v-61d83e97"]]);export{Ve as default};
