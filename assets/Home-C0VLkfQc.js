import{r as pt}from"./resident-CqofEgMf.js";import{P as C,G as mt,B as E}from"./base-util-LDrhyDoM.js";import{r as gt,a as vt}from"./building-sale-DAoCUAi5.js";import{d as ht,r,l as _t,c as u,o,i as s,a as l,u as M,e as A,t as i,b as p,F as m,h as g,n as T,j as Mt,f as U,m as Y,p as ft,_ as yt}from"./index-Dh5izbV7.js";const wt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACIAAAAoCAMAAACsAtiWAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAABFUExURUxpcTMzMzIyMjMzMzMzMzMzMzMzMzIyMjMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzIyMjMzMzIyMjMzMzMzMxWweaYAAAAWdFJOUwCYCoSzie59zkKt3/dOFSEyom+4YsFNhQqhAAAA7UlEQVQ4y4XTWRKEIAwEUARFEBXcuP9Rh3KbJEToP60nSgeF+EfavjVau6Ozs+DilY5vxiXkQkWShqzkTcyiJyhsZLNWBTA+fuZ5l/kmozzFHgtZTqJLJPraIqmeRDZchjkcuuHoe5TM1g24k/3aYkBPiR5cDU9THdpTA67seyxG+Bwk8h0JaLNFxL/EQaK4qQX0gRPpIJtaI2a4QXOdtIUMG815VNauqF4tcQdM2rTqXCZnV01JmKzKLPfvNH0LxU2NOZYls8F/rasK1mz0t++4zkj6qiCGFch8CGAGISqmIG5TFKepiHQ0DnrnB0GTR7aqrADlAAAAAElFTkSuQmCC",zt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAKBAMAAAByAqLJAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAbUExURTMzM0xpcTMzMzMzMzU1NUBAQDMzMzIyMjMzM++Kl1gAAAAJdFJOU/8AtIAhCN5MS/NhRvEAAAA/SURBVAjXY1BgAAImBgcQxcIgDKIMGUQTGBjYAhkECxgY2AUZBIUYGBSBlAgDgyOQEjRgFgRRYalgSqJQUBAAjgsFH4pUp/cAAAAASUVORK5CYII=",kt="/future-commurtity-h5/assets/more-app-BoGBHSuz.gif",Ut="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEoAAABECAMAAAARBFMzAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAABgUExURUxpcTU6RDQ8RjQ+SACQ/yRmoTU7RTU7RjU8QzY8RQGO+zc8RjU7RQCO/jU6RQCP/zY8RQCQ/wCP/zU7RTQ7RQCP/wCP/wCP/wCP/ylPdBdtshZsswCP/zU7RRB1xSZRdrGEwBcAAAAcdFJOUwCZZiJ3Ee67RHdJM93wiLtVKqKqzIhmzN13iLtuqOL3AAADRUlEQVRYw+1X2bLbIAwN3gBv8ZqkbXLv//9lbYRAIuBk2ofOdHKeMHYUdLQdTqcP/j2m847VrHu5Q9PXymz126oxqyxtqbjv6EbzkD0MSvJemB3tXuqkpdpYul/sYxV+npuNajeuzVKlLJWdsbTiM3xe+Q962Nhdg79ZpEdDTV2Npas3Dd9nwXMC9IQrJYpQ0/JTpvBMVH0KuXkM9rE9srT4n41AVMHYg2NJTAUPeNGTHU9VCUSdeSAU/GPzFKH+IIATEFUWANyW5idiXzbkCGoBz8lOjj+5AFEj5Oh9wn2bpvt3yyHpPv1WUzCX8R66ObsCObbkYoOE3YylWxlhoHlhqokSNpJ4OQoaeYxYMWMJQhbNf9RgbI6uLN6+MZSHh2oixXwOyMmCHEuA0XsOKQ88PKzA6vRGMVdBET2B1Vak6+0YeMLIoGgRYX8cg65HuqigPxFPlhRnFLse4jtCQ55o5iIo7IlZ+orl8fAe6xdmqQu+618H0PvXpd1zDXl+y1ISShtAu9FJ5B8p8h9BYUzZgHKwfafmcy0OJ5ai+qLKacVPL45VQVbnUUsNq9PVDt0saFsZ6+ODOhhw9Z2jT2ii3PVeoK3xrSBjI9IjrElgIVe22EqkbTPacPm4BpY6EZVX7qyuVT9QIT5QIo/1Bjsoi21pBYjC00sqV7Zu+0JY4MwtXX/eZ5YmTc0Ji0SjbEMh4Kdk5RqZ/T+tzcgTYGrjbMFFxVUmkXPerSUSwNwctdLWslv4gUWUgHeLT+cZ5pKMOyhis1JipihGgrKJ0aZp593fzSSF2SPp3G01uCm0FnyxfV/e46acp5pLFLCfoZJ2i/y5ar58bCWtCcxKnR6XRdzU7NRAww419HFTkk/wghTI5lZJy2arPzgsUIa14xY9C19XEk8GPMjCFISGo2pMZJ0rxigRKAVxSzM9ZxM05+FVGVMflK2JuNWzMrW3WMXDiy11pkIVcLNuSeep4hdGwcLb2uLqS8q59RJK7CGV5cD2Pad2llBViI14oRXh/IZ3RhHtHce3WEvDFa+d4OdPGe1o2RvXoIu7j4Ei/xXTcladV4fXIMv5LsQhkF90agmnQ+G2qpLY+zpMvtotf3wEzV/iN98v5kPP0rzzAAAAAElFTkSuQmCC",Ct="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwBAMAAAClLOS0AAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAwUExURUxpcXaMpneNpHeMpHiNpHeOpHiNpHiNpHiNpHiNpHiNpHiNpHmMpHmPoXaMpHiNpDTB1HsAAAAPdFJOUwAPaUyMLN7BqpvvzIEcLyBbviIAAACESURBVDjLY2AYMcAWhzjnbwHsEiz/G7BLMNZ/wWFW2H8F7BLM/z/j0KL/KwC7BM//jTi0zP+BQ0L8vwN2Cdb8Tzi0WP03wC7B9D8Vh5bz33EEGOf/CbgkHEgziul/HmnOxelBnEHS/wNXrG/EFVEPSItaXIkBZ/LBmeBYcCVRBl2GkQUAn7IrC/f2z58AAAAASUVORK5CYII=",Bt="data:image/svg+xml,%3c?xml%20version='1.0'%20standalone='no'?%3e%3c!DOCTYPE%20svg%20PUBLIC%20'-//W3C//DTD%20SVG%201.1//EN'%20'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3csvg%20t='1646352021532'%20class='icon'%20viewBox='0%200%201024%201024'%20version='1.1'%20xmlns='http://www.w3.org/2000/svg'%20p-id='10106'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20width='48'%20height='48'%3e%3cdefs%3e%3cstyle%20type='text/css'%3e%3c/style%3e%3c/defs%3e%3cpath%20d='M512%20512m-512%200a512%20512%200%201%200%201024%200%20512%20512%200%201%200-1024%200Z'%20fill='%23A7F9DE'%20p-id='10107'%3e%3c/path%3e%3cpath%20d='M409.134545%20282.298182l-101.236363-101.236364a23.272727%2023.272727%200%200%200-33.047273%201.629091l-74.938182%2091.461818a111.709091%20111.709091%200%200%200-6.050909%20134.050909%201661.905455%201661.905455%200%200%200%20421.934546%20421.701819%20111.709091%20111.709091%200%200%200%20134.050909-6.05091l91.461818-74.705454a23.272727%2023.272727%200%200%200%201.629091-33.047273l-101.003637-101.003636a44.683636%2044.683636%200%200%200-53.294545-7.447273l-83.316364%2046.545455a44.683636%2044.683636%200%200%201-53.294545-7.447273l-174.312727-174.312727a44.683636%2044.683636%200%200%201-7.447273-53.527273l46.545454-83.316364a44.683636%2044.683636%200%200%200-7.68-53.294545z'%20fill='%231CD38D'%20p-id='10108'%3e%3c/path%3e%3c/svg%3e",Pt="/future-commurtity-h5/assets/live3-DtT8MrGd.png",Lt="/future-commurtity-h5/assets/live2-B_jW1x1f.png",bt="/future-commurtity-h5/assets/live1-BswXrmvN.png",Rt="/future-commurtity-h5/assets/news2-vJiAwfMF.png",Et="/future-commurtity-h5/assets/news3-DLRbg5MM.png",Tt="/future-commurtity-h5/assets/news4-DocdMIkU.png",It="/h5/community",Nt={communityMap:v=>new C(`${It}/map`,v).request()},xt="/h5/banner",St={bannerList:v=>new C(`${xt}/list`,v).request()},Ht="/h5/guide",Ft={guideHome:()=>new C(`${Ht}/home`,{}).request()},Gt="/h5/notice",Ot={page:v=>new C(`${Gt}/list`,v).request()},qt="/h5/car_parking",Vt={number:()=>new mt(`${qt}/number`).request()},Qt="/h5/activity",Dt={page:v=>new C(`${Qt}/list`,v).request()},Xt={class:"page"},Kt={class:"community-name"},Yt={class:"menu-grid"},jt={class:"menu-tab"},Jt=["onClick"],Zt={class:"menu-item"},Wt={class:"notice"},$t={class:"notice-swipe-item_content"},te={class:"common-module-title"},ee={class:"title"},se={class:"function-list-item"},ne={key:1,class:"function-list-item-parking"},ae={class:"function-list-item-parking_info"},oe={class:"parking-count btm-line"},ie={class:"value blue-color"},le={class:"parking-count"},ce={class:"value orange-color"},ue={class:"function-list-item-parking_img"},re={class:"activity-list"},de={class:"info"},Ae={class:"title"},pe={class:"desc"},me={class:"create-date"},ge={class:"house-box"},ve={class:"house-tab"},he=["onClick"],_e=["onClick"],Me={class:"info"},fe={class:"title"},ye={class:"tips"},we={class:"orange"},ze={class:"orange"},ke={class:"tags"},Ue={class:"price"},Ce={key:0,class:"call"},Be=["href"],Pe=ht({__name:"Home",setup(v){const I=r(""),O=r(),q=r([]),B=r([]),f=r(!1),N=r([]),y=r([]),h=r(0),V=Mt(),Q=r([]),j=r([{title:"善生活",module1:{title:"二手闲置",icon:Pt,linkPath:"/trade/list",type:"img"},module2:{title:"积分商城",icon:Lt,linkPath:"/integral/manager",type:"img"},module3:{title:"艺术课堂",icon:bt,linkPath:"/home/classroomArt",type:"img"}},{title:"善资讯",module1:{title:"车位数据展示",icon:"",linkPath:"",type:"div"},module2:{title:"微家园",icon:Rt,linkPath:"/notice/list",type:"img"},module3:{title:"招募志愿者",icon:Et,linkPath:"/notice/list",type:"img"}}]);_t(async()=>{await ut(),await rt(),it(),ot(),nt(),st(),et(),X()});function J(n){P.value=n,P.value===0?X():tt()}const x=r([]),Z=["进行中","已完成","已下架"],W=["出租","出售"],P=r(0);function D(n){const t=(a,_)=>(a?`${a}·`:"")+(_?`${_}·`:"");return n.map(a=>{const{id:_,introduction:S,status:w,type:z,contactPhone:H,coverPath:b,rentalPrice:F,salePrice:G,priceUnitName:e,buildingTradeTags:c}=a,d={id:_,introduction:S,status:w,type:z,contactPhone:H,cover:b?E.getUploadPath(b):"",price:F||G,priceUnit:e||"元/月",tagList:c||[]};if(c&&c.length>0){const k={title:Z[w-1]};d?.tagList?.unshift(k)}if(z===1){const{name:k,unit:R}=a.building??{},{typeName:dt,area:At}=a.room??{};d.address=`${k??""}${R?.name?`(${R?.name})`:""}`,d.roomArea=t("",At),d.roomType=t(dt,"")}else{const{typeName:k,address:R}=a.carParking??{};d.address=R||"",d.roomType=t(k,"")}return console.log("处理后的房产数据",d),d})}const $=n=>{const t=P.value===0?"rental":"sale";V.push({path:"/house/detail",query:{id:n.id,type:t}})};async function X(){const{data:n}=await gt.page({pageNum:1,pageSize:3});x.value=D(n.list||[])}async function tt(){const{data:n}=await vt.page({pageNum:1,pageSize:3});x.value=D(n.list||[])}const K=r([]);async function et(){const{data:n}=await Dt.page({pageNum:1,pageSize:4});K.value=(n.list||[]).map(t=>({...t,cover:t.cover?E.getUploadPath(t.cover):"",introduction:t.introduction?t.introduction.replace(/<[^>]+>/g,"").substring(0,30)+"...":"",startTime:t.startTime?t.startTime.substring(0,10):""}))}const L=r({up:0,down:0});async function st(){const{data:n}=await Vt.number();n&&(L.value.up=n[1].lastSpaceCount||0,L.value.down=n[2].lastSpaceCount||0)}async function nt(){const{data:n}=await Ot.page({pageNum:1,pageSize:10});Q.value=n.list||[]}function at(n){n.linkPath&&V.push({path:n.linkPath})}async function ot(){const{data:n}=await Ft.guideHome();n&&(y.value=(n||[]).filter(t=>t.isShowHome===1).map(t=>(t.itemList&&t.itemList.length>0&&(t.itemList=t.itemList.filter(a=>a.isShow===1).map(a=>({...a,icon:a.icon?E.getUploadPath(a.icon):""})),t.itemList.push({title:"更多应用",icon:kt,linkPath:"/menu/all"})),t)),console.log("功能导航列表",y.value))}function it(){const n={pageNum:1,pageSize:10};St.bannerList(n).then(({data:t})=>{t&&(N.value=(t.list||[]).map(a=>({...a,filePath:a.filePath?E.getUploadPath(a.filePath):""})),console.log("轮播图列表",N.value))})}function lt(n){console.log("选择的社区",n),I.value=n.selectedOptions[0].name||"未选择社区",f.value=!1}function ct(){f.value=!1}async function ut(){const{data:n}=await pt.my();console.log("住户信息",n),n&&(B.value=n.roomList?.map(t=>({id:t.community?.id,name:t.community?.name}))??[],console.log("用户社区列表",B.value),O.value=B.value?.[0]?.name??"未选择社区")}async function rt(){const n={pageNum:1,pageSize:999},{data:t}=await Nt.communityMap(n);console.log("社区列表",t),t&&t.length>0&&(q.value=B.value||t,I.value=O.value||(t[0].name??"未选择社区"))}return(n,t)=>{const a=A("van-image"),_=A("van-picker"),S=A("van-popup"),w=A("van-swipe-item"),z=A("van-swipe"),H=A("van-grid-item"),b=A("van-grid"),F=A("van-notice-bar"),G=A("van-tag");return o(),u("div",Xt,[s("div",{class:"community-picker",onClick:t[0]||(t[0]=e=>f.value=!0)},[l(a,{src:M(wt),class:"local-icon",alt:"地址"},null,8,["src"]),s("span",Kt,i(I.value),1),l(a,{src:M(zt),class:"arrow-icon",alt:"箭头"},null,8,["src"])]),l(S,{show:f.value,"onUpdate:show":t[1]||(t[1]=e=>f.value=e),position:"bottom",round:""},{default:p(()=>[l(_,{title:"请选择社区",columns:q.value,"columns-field-names":{text:"name",value:"id"},onConfirm:lt,onCancel:ct},null,8,["columns"])]),_:1},8,["show"]),l(z,{autoplay:3e3,"indicator-color":"#fff",class:"banner-swipe"},{default:p(()=>[(o(!0),u(m,null,g(N.value,e=>(o(),U(w,{key:e.id},{default:p(()=>[l(a,{src:e.filePath,width:"100%",height:"100%",class:"banner-image"},null,8,["src"])]),_:2},1024))),128))]),_:1}),s("div",Yt,[s("div",jt,[(o(!0),u(m,null,g(y.value,(e,c)=>(o(),u("div",{class:T(["menu-tab_item",h.value===c?"menu-tab_item_selected":"menu-tab_item_default"]),key:e.id,onClick:d=>h.value=c},i(e.title),11,Jt))),128))]),s("div",Zt,[s("div",{class:T(["menu-item_container",h.value===0?"menu-item_r1":h.value===1?"menu-item_r2":"menu-item_r3"])},[l(b,{border:!1},{default:p(()=>[y.value[h.value]?(o(!0),u(m,{key:0},g(y.value[h.value].itemList,e=>(o(),U(H,{key:e.id,icon:e.icon,text:e.title,onClick:c=>at(e)},null,8,["icon","text","onClick"]))),128)):Y("",!0)]),_:1})],2)])]),s("div",Wt,[l(a,{src:M(Ut),class:"notice-img"},null,8,["src"]),t[2]||(t[2]=s("span",{class:"notice-spot"},"·",-1)),l(F,{class:"notice-bar",scrollable:!1},{"right-icon":p(()=>[l(a,{src:M(Ct),class:"right-arrow-icon",alt:"箭头"},null,8,["src"])]),default:p(()=>[l(z,{vertical:"",class:"notice-swipe",autoplay:3e3,touchable:!1,"show-indicators":!1},{default:p(()=>[(o(!0),u(m,null,g(Q.value,e=>(o(),U(w,{key:e.id,class:"notice-swipe-item"},{default:p(()=>[s("div",$t,i(e.title),1)]),_:2},1024))),128))]),_:1})]),_:1})]),(o(!0),u(m,null,g(j.value,e=>(o(),u("div",{class:"function-list",key:e.title},[s("div",te,[s("span",ee,i(e.title),1)]),s("div",se,[e.module1.type==="img"?(o(),U(a,{key:0,class:"function-list-item_icon1",src:e.module1.icon,alt:""},null,8,["src"])):(o(),u("div",ne,[s("div",ae,[t[5]||(t[5]=s("div",{class:"title"},"剩余停车位",-1)),s("div",oe,[t[3]||(t[3]=s("span",{class:"label"},"地上",-1)),s("span",ie,i(L.value.up),1)]),s("div",le,[t[4]||(t[4]=s("span",{class:"label"},"地下",-1)),s("span",ce,i(L.value.down),1)])]),s("div",ue,[l(a,{src:M(Tt),alt:"",width:"100%",height:"100%"},null,8,["src"])])])),l(a,{class:"function-list-item_icon2",src:e.module2.icon,alt:""},null,8,["src"]),l(a,{class:"function-list-item_icon3",src:e.module3.icon,alt:""},null,8,["src"])])]))),128)),t[6]||(t[6]=s("div",{class:"common-module-title"},[s("span",{class:"title"},"善活动"),s("span",{class:"more-btn"},"更多")],-1)),s("div",re,[(o(!0),u(m,null,g(K.value,e=>(o(),u("div",{class:"activity-list-item",key:e.id},[l(a,{src:e.cover,alt:"",class:"cover"},null,8,["src"]),s("div",de,[s("div",Ae,i(e.title),1),s("div",pe,i(e.introduction),1),s("div",me,i(e.startTime),1)])]))),128))]),t[7]||(t[7]=s("div",{class:"common-module-title"},[s("span",{class:"title"},"善房产"),s("span",{class:"more-btn"},"更多")],-1)),s("div",ge,[s("div",ve,[(o(),u(m,null,g(W,(e,c)=>s("div",{class:T(["house-tab-item",{"house-tab-active":P.value===c}]),key:e,onClick:d=>J(c)},i(e),11,he)),64))]),(o(!0),u(m,null,g(x.value,e=>(o(),u("div",{class:"house-list",key:e.id,onClick:c=>$(e)},[l(a,{src:e.cover,alt:"",class:"cover"},null,8,["src"]),s("div",Me,[s("div",fe,[s("span",{class:T(["icon",{house:e.type===1,car:e.type===2}])},i(["房","车"][e.type-1]),3),s("span",null,i(e.introduction),1)]),s("div",ye,[s("span",we,i(e.roomType),1),s("span",ze,i(e.roomArea),1),s("span",null,i(e.address),1)]),s("div",ke,[(o(!0),u(m,null,g(e.tagList,c=>(o(),U(G,{key:c.title,plain:c.title!=="进行中"&&c.title!=="已完成",type:"primary"},{default:p(()=>[ft(i(c.title),1)]),_:2},1032,["plain"]))),128))]),s("div",Ue,[s("span",null,i(e.price),1),s("span",null,i(e.priceUnit),1)])]),e.status===1&&e.contactPhone?(o(),u("div",Ce,[s("a",{href:`tel:${e.contactPhone}`},[l(a,{src:M(Bt),alt:"",class:"call-icon"},null,8,["src"])],8,Be)])):Y("",!0)],8,_e))),128))])])}}}),Te=yt(Pe,[["__scopeId","data-v-ed773ba5"]]);export{Te as default};
